<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>提交对 <span id="name"></span> 的了解</title>
    <link rel="stylesheet" href="johari.css">
    <script>
        let userwords = ""; // 定义一个全局变量来存储 userwords

        // 获取 URL 查询参数
        function getQueryParams() {
            const urlParams = new URLSearchParams(window.location.search);
            const name = urlParams.get('name');
            userwords = urlParams.get('userwords'); // 将 userwords 存储到全局变量
            //otherwords = urlParams.get('otherwords'); // 将 otherwords 存储到全局变量
            if (name) {
                document.getElementById('name').textContent = name;
            }
        }

        function submitForm() {
            const name = document.getElementById('name').textContent;  // 获取姓名
            const selectedWords = Array.from(document.querySelectorAll('button.selected')).map(button => button.textContent); // 获取当前选中的词汇
            // 如果选择的词汇数量不在 5 到 6 之间，弹出提示并返回
            if (selectedWords.length < 5 || selectedWords.length > 6) {
                alert('请选择5到6个词汇！');
                return;
            }

            // 从 URL 获取之前的 otherwords 参数，并将其转换为数组
            const urlParams = new URLSearchParams(window.location.search);
            const existingOtherWords = urlParams.get('otherwords');
            const otherwordsArray = existingOtherWords ? existingOtherWords.split(',') : [];
        
            // 合并之前的 otherwords 和当前选中的词汇，去重
            const mergedWords = [...new Set([...otherwordsArray, ...selectedWords])];
        
            // 构建URL，将数据传递到 result.html 页面
            const url = new URL('result.html', window.location.href);
            url.searchParams.set('name', name);  // 将姓名添加到URL中
            url.searchParams.set('userwords', userwords);  // 使用全局变量 userwords
            url.searchParams.set('otherwords', mergedWords.join(','));  // 将合并后的词汇传递到URL中
        
            // 跳转到结果页面
            window.location.href = url;
        }
        

        function toggleSelection(button) {
            button.classList.toggle('selected');
        }

        window.onload = getQueryParams;  // 页面加载时执行getQueryParams函数
    </script>
</head>
<body>
    <div class="container">
        <h1>提交对 <span id="name"></span> 的了解</h1>
        <p>请选择五到六个您认为描述 <span id="name"></span> 的词汇：</p>

        <div id="words-container">
            <div class="row">
                <button type="button" onclick="toggleSelection(this)">able</button>
                <button type="button" onclick="toggleSelection(this)">accepting</button>
                <button type="button" onclick="toggleSelection(this)">adaptable</button>
                <button type="button" onclick="toggleSelection(this)">bold</button>
                <button type="button" onclick="toggleSelection(this)">brave</button>
            </div>
            <div class="row">
                <button type="button" onclick="toggleSelection(this)">calm</button>
                <button type="button" onclick="toggleSelection(this)">caring</button>
                <button type="button" onclick="toggleSelection(this)">cheerful</button>
                <button type="button" onclick="toggleSelection(this)">clever</button>
                <button type="button" onclick="toggleSelection(this)">complex</button>
            </div>
            <div class="row">
                <button type="button" onclick="toggleSelection(this)">confident</button>
                <button type="button" onclick="toggleSelection(this)">dependable</button>
                <button type="button" onclick="toggleSelection(this)">dignified</button>
                <button type="button" onclick="toggleSelection(this)">energetic</button>
                <button type="button" onclick="toggleSelection(this)">extroverted</button>
            </div>
            <div class="row">
                <button type="button" onclick="toggleSelection(this)">friendly</button>
                <button type="button" onclick="toggleSelection(this)">giving</button>
                <button type="button" onclick="toggleSelection(this)">happy</button>
                <button type="button" onclick="toggleSelection(this)">helpful</button>
                <button type="button" onclick="toggleSelection(this)">idealistic</button>
            </div>
            <div class="row">
                <button type="button" onclick="toggleSelection(this)">independent</button>
                <button type="button" onclick="toggleSelection(this)">ingenious</button>
                <button type="button" onclick="toggleSelection(this)">intelligent</button>
                <button type="button" onclick="toggleSelection(this)">introverted</button>
                <button type="button" onclick="toggleSelection(this)">kind</button>
            </div>
            <div class="row">
                <button type="button" onclick="toggleSelection(this)">knowledgeable</button>
                <button type="button" onclick="toggleSelection(this)">logical</button>
                <button type="button" onclick="toggleSelection(this)">loving</button>
                <button type="button" onclick="toggleSelection(this)">mature</button>
                <button type="button" onclick="toggleSelection(this)">modest</button>
            </div>
            <div class="row">
                <button type="button" onclick="toggleSelection(this)">nervous</button>
                <button type="button" onclick="toggleSelection(this)">observant</button>
                <button type="button" onclick="toggleSelection(this)">organised</button>
                <button type="button" onclick="toggleSelection(this)">patient</button>
                <button type="button" onclick="toggleSelection(this)">powerful</button>
            </div>
            <div class="row">
                <button type="button" onclick="toggleSelection(this)">proud</button>
                <button type="button" onclick="toggleSelection(this)">quiet</button>
                <button type="button" onclick="toggleSelection(this)">reflective</button>
                <button type="button" onclick="toggleSelection(this)">relaxed</button>
                <button type="button" onclick="toggleSelection(this)">religious</button>
            </div>
            <div class="row">
                <button type="button" onclick="toggleSelection(this)">responsive</button>
                <button type="button" onclick="toggleSelection(this)">searching</button>
                <button type="button" onclick="toggleSelection(this)">self-assertive</button>
                <button type="button" onclick="toggleSelection(this)">self-conscious</button>
                <button type="button" onclick="toggleSelection(this)">sensible</button>
            </div>
            <div class="row">
                <button type="button" onclick="toggleSelection(this)">sentimental</button>
                <button type="button" onclick="toggleSelection(this)">shy</button>
                <button type="button" onclick="toggleSelection(this)">silly</button>
                <button type="button" onclick="toggleSelection(this)">spontaneous</button>
                <button type="button" onclick="toggleSelection(this)">sympathetic</button>
            </div>
            <div class="row">
                <button type="button" onclick="toggleSelection(this)">tense</button>
                <button type="button" onclick="toggleSelection(this)">trustworthy</button>
                <button type="button" onclick="toggleSelection(this)">warm</button>
                <button type="button" onclick="toggleSelection(this)">wise</button>
                <button type="button" onclick="toggleSelection(this)">witty</button>
            </div>
        </div>

        <button onclick="submitForm()">提交并查看结果</button>
    </div>
</body>
</html>
